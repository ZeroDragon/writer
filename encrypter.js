async function bufferToHex(e){e=new Uint8Array(e);return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}async function hexToBuffer(e){return hexToBytes(e).buffer}async function createHash(e){e=(new TextEncoder).encode(e),e=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(e)).slice(0,16).map(e=>e.toString(16).padStart(2,"0")).join("")}function hexToBytes(t){var r=new Uint8Array(t.length/2);for(let e=0;e<r.length;e++)r[e]=parseInt(t.substr(2*e,2),16);return r}async function encryptText(e,t,r){t=await createHash(t),r=await createHash(r),t=await crypto.subtle.importKey("raw",hexToBytes(t),{name:"AES-CBC"},!1,["encrypt"]),r=hexToBytes(r),e=(new TextEncoder).encode(e);return bufferToHex(await crypto.subtle.encrypt({name:"AES-CBC",iv:r},t,e))}async function decryptText(e,t,r){t=await createHash(t),r=await createHash(r),t=await crypto.subtle.importKey("raw",hexToBytes(t),{name:"AES-CBC"},!1,["decrypt"]),r=hexToBytes(r),e=await hexToBuffer(e),r=await crypto.subtle.decrypt({name:"AES-CBC",iv:r},t,e);return(new TextDecoder).decode(r)}